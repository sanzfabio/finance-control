<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Control Pro v2.2</title>
    <style>
        :root {
            --color-bg-base: #0f172a;
            --color-bg-elevated: #020617;
            --color-bg-surface: #1e293b;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-text-muted: #94a3b8;
            --color-accent: #38bdf8;
            --color-accent-hover: #0284c7;
            --color-success: #10b981;
            --color-danger: #ef4444;
            --color-warning: #f59e0b;
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: var(--color-bg-base); 
            color: var(--color-text-primary); 
            font-family: var(--font-family); 
            line-height: 1.6; 
            padding: var(--spacing-md); 
        }
        .container { max-width: 1400px; margin: 0 auto; }
        header { 
            background-color: var(--color-bg-elevated); 
            padding: var(--spacing-lg); 
            border-radius: 8px; 
            margin-bottom: var(--spacing-lg); 
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); 
        }
        h1 { font-size: 2rem; margin-bottom: var(--spacing-xs); color: var(--color-accent); }
        h2 { color: var(--color-accent); margin-bottom: var(--spacing-md); }
        h3 { color: var(--color-accent); }
        .header-subtitle { color: var(--color-text-secondary); font-size: 0.9rem; }
        .version-badge { 
            display: inline-block; 
            background: var(--color-accent); 
            color: var(--color-bg-elevated); 
            padding: 0.25rem 0.75rem; 
            border-radius: 12px; 
            font-size: 0.75rem; 
            font-weight: 600; 
            margin-left: 1rem; 
        }
        .dashboard { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: var(--spacing-md); 
            margin-bottom: var(--spacing-lg); 
        }
        .stat-card { 
            background-color: var(--color-bg-surface); 
            padding: var(--spacing-lg); 
            border-radius: 8px; 
            border-left: 4px solid var(--color-accent); 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); 
            transition: transform 0.2s; 
        }
        .stat-card:hover { transform: translateY(-2px); }
        .stat-label { 
            font-size: 0.85rem; 
            color: var(--color-text-muted); 
            margin-bottom: var(--spacing-xs); 
            text-transform: uppercase; 
            letter-spacing: 0.5px; 
        }
        .stat-value { font-size: 1.8rem; font-weight: 600; color: var(--color-text-primary); }
        .stat-value.income { color: var(--color-success); }
        .stat-value.expense { color: var(--color-danger); }
        .stat-value.balance { color: var(--color-accent); }
        .stat-subtitle { font-size: 0.75rem; color: var(--color-text-muted); margin-top: 0.25rem; }
        .controls { 
            background-color: var(--color-bg-surface); 
            padding: var(--spacing-lg); 
            border-radius: 8px; 
            margin-bottom: var(--spacing-lg); 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); 
        }
        .form-group { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: var(--spacing-md); 
            margin-bottom: var(--spacing-md); 
        }
        .form-field { display: flex; flex-direction: column; }
        label { 
            font-size: 0.9rem; 
            color: var(--color-text-secondary); 
            margin-bottom: var(--spacing-xs); 
            font-weight: 500; 
        }
        input, select, textarea { 
            padding: var(--spacing-sm); 
            background-color: var(--color-bg-base); 
            border: 1px solid var(--color-text-muted); 
            border-radius: 6px; 
            color: var(--color-text-primary); 
            font-family: var(--font-family); 
            font-size: 0.95rem; 
            transition: border-color 0.2s; 
        }
        input:focus, select:focus, textarea:focus { 
            outline: none; 
            border-color: var(--color-accent); 
            box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.2); 
        }
        input::placeholder { color: var(--color-text-muted); }
        .button-group { display: flex; gap: var(--spacing-sm); flex-wrap: wrap; }
        button { 
            padding: var(--spacing-sm) var(--spacing-lg); 
            border: none; 
            border-radius: 6px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.2s; 
            font-size: 0.95rem; 
        }
        .btn-primary { background-color: var(--color-accent); color: var(--color-bg-elevated); }
        .btn-primary:hover { 
            background-color: var(--color-accent-hover); 
            transform: translateY(-2px); 
            box-shadow: 0 4px 12px rgba(56, 189, 248, 0.3); 
        }
        .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .btn-secondary { 
            background-color: var(--color-bg-elevated); 
            color: var(--color-text-primary); 
            border: 1px solid var(--color-text-muted); 
        }
        .btn-secondary:hover { background-color: var(--color-bg-surface); }
        .btn-danger { background-color: var(--color-danger); color: white; }
        .btn-danger:hover { background-color: #dc2626; }
        .btn-success { background-color: var(--color-success); color: white; }
        .btn-success:hover { background-color: #059669; }
        .suggestion-box { 
            background: rgba(56, 189, 248, 0.1); 
            border: 1px solid var(--color-accent); 
            border-radius: 6px; 
            padding: var(--spacing-sm); 
            margin-top: var(--spacing-xs); 
            display: none; 
        }
        .suggestion-box.show { display: flex; align-items: center; gap: var(--spacing-sm); }
        .suggestion-text { flex: 1; font-size: 0.9rem; }
        .suggestion-actions { display: flex; gap: var(--spacing-xs); }
        .tabs { 
            display: flex; 
            gap: var(--spacing-md); 
            margin-bottom: var(--spacing-lg); 
            border-bottom: 2px solid var(--color-text-muted); 
            flex-wrap: wrap; 
        }
        .tab { 
            padding: var(--spacing-sm) var(--spacing-md); 
            background: none; 
            border: none; 
            color: var(--color-text-secondary); 
            cursor: pointer; 
            font-weight: 500; 
            border-bottom: 2px solid transparent; 
            margin-bottom: -2px; 
            transition: all 0.2s; 
            font-size: 0.95rem; 
        }
        .tab.active { color: var(--color-accent); border-bottom-color: var(--color-accent); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .transactions { 
            background-color: var(--color-bg-surface); 
            border-radius: 8px; 
            overflow: hidden; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); 
        }
        .transactions-header { 
            background-color: var(--color-bg-elevated); 
            padding: var(--spacing-lg); 
            border-bottom: 1px solid var(--color-text-muted); 
            font-weight: 600; 
            display: grid; 
            grid-template-columns: 2fr 1fr 1fr 1.5fr 0.5fr 1fr; 
            gap: var(--spacing-md); 
            font-size: 0.9rem; 
            text-transform: uppercase; 
            letter-spacing: 0.5px; 
            color: var(--color-text-muted); 
        }
        .transaction-item { 
            padding: var(--spacing-lg); 
            border-bottom: 1px solid rgba(148, 163, 184, 0.1); 
            display: grid; 
            grid-template-columns: 2fr 1fr 1fr 1.5fr 0.5fr 1fr; 
            gap: var(--spacing-md); 
            align-items: center; 
            transition: background-color 0.2s; 
        }
        .transaction-item:hover { background-color: rgba(56, 189, 248, 0.05); }
        .transaction-desc { display: flex; flex-direction: column; }
        .transaction-desc strong { color: var(--color-text-primary); margin-bottom: var(--spacing-xs); }
        .transaction-desc small { color: var(--color-text-muted); font-size: 0.85rem; }
        .transaction-amount { font-weight: 600; font-size: 1.1rem; }
        .transaction-amount.income { color: var(--color-success); }
        .transaction-amount.expense { color: var(--color-danger); }
        .transaction-account { font-size: 0.85rem; color: var(--color-text-muted); }
        .budget-progress { 
            background-color: var(--color-bg-elevated); 
            border-radius: 8px; 
            padding: var(--spacing-md); 
            margin-bottom: var(--spacing-md); 
        }
        .budget-category { margin-bottom: var(--spacing-md); }
        .budget-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: var(--spacing-xs); 
        }
        .budget-name { font-weight: 600; }
        .budget-amounts { font-size: 0.85rem; color: var(--color-text-muted); }
        .budget-bar { 
            height: 8px; 
            background-color: var(--color-bg-base); 
            border-radius: 4px; 
            overflow: hidden; 
        }
        .budget-fill { height: 100%; transition: width 0.3s, background-color 0.3s; }
        .budget-fill.safe { background-color: var(--color-success); }
        .budget-fill.warning { background-color: var(--color-warning); }
        .budget-fill.danger { background-color: var(--color-danger); }
        .goal-card { 
            background-color: var(--color-bg-elevated); 
            border-radius: 8px; 
            padding: var(--spacing-md); 
            margin-bottom: var(--spacing-md); 
            border-left: 4px solid var(--color-accent); 
        }
        .goal-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: var(--spacing-sm); 
        }
        .goal-name { font-size: 1.1rem; font-weight: 600; }
        .goal-progress-text { font-size: 0.9rem; color: var(--color-text-muted); }
        .alert { 
            padding: var(--spacing-md); 
            border-radius: 6px; 
            margin-bottom: var(--spacing-md); 
            display: flex; 
            align-items: center; 
            gap: var(--spacing-sm); 
        }
        .alert.warning { 
            background-color: rgba(245, 158, 11, 0.1); 
            border-left: 4px solid var(--color-warning); 
        }
        .alert.success { 
            background-color: rgba(16, 185, 129, 0.1); 
            border-left: 4px solid var(--color-success); 
        }
        .alert-icon { font-size: 1.5rem; }
        .no-data { text-align: center; padding: var(--spacing-xl); color: var(--color-text-muted); }
        .modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0, 0, 0, 0.7); 
            z-index: 1000; 
            align-items: center; 
            justify-content: center; 
        }
        .modal.show { display: flex; }
        .modal-content { 
            background-color: var(--color-bg-surface); 
            padding: var(--spacing-lg); 
            border-radius: 8px; 
            max-width: 600px; 
            width: 90%; 
            max-height: 80vh; 
            overflow-y: auto; 
        }
        .modal-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: var(--spacing-lg); 
        }
        .modal-title { font-size: 1.5rem; font-weight: 600; color: var(--color-accent); }
        .modal-close { 
            background: none; 
            border: none; 
            font-size: 1.5rem; 
            color: var(--color-text-muted); 
            cursor: pointer; 
            padding: 0; 
        }
        .modal-close:hover { color: var(--color-text-primary); }
        @media (max-width: 768px) {
            .transactions-header, .transaction-item { grid-template-columns: 1fr; }
            .dashboard { grid-template-columns: 1fr; }
            h1 { font-size: 1.5rem; }
            .form-group { grid-template-columns: 1fr; }
            .tabs { overflow-x: auto; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: var(--spacing-md);">
                <div>
                    <h1>üí∞ Finance Control Pro <span class="version-badge">v2.2</span></h1>
                    <p class="header-subtitle">Planejamento Financeiro Familiar com FP&A</p>
                </div>
                <div class="button-group">
                    <button id="googleSignInBtn" class="btn-primary">üîê Login Google</button>
                    <button id="googleSignOutBtn" class="btn-secondary" style="display: none;">üö™ Sair</button>
                    <button id="syncBtn" class="btn-secondary" disabled>‚òÅÔ∏è Sincronizar</button>
                </div>
            </div>
        </header>

        <div id="alertsContainer"></div>

        <div class="dashboard">
            <div class="stat-card">
                <div class="stat-label">Receitas do M√™s</div>
                <div class="stat-value income" id="totalIncome">R$ 0,00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Despesas do M√™s</div>
                <div class="stat-value expense" id="totalExpense">R$ 0,00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Saldo do M√™s</div>
                <div class="stat-value balance" id="balance">R$ 0,00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Taxa de Poupan√ßa</div>
                <div class="stat-value" id="savingsRate">0%</div>
                <div class="stat-subtitle">Meta: 20%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Runway (Meses)</div>
                <div class="stat-value" id="runway">0.0</div>
                <div class="stat-subtitle">Reserva emerg√™ncia</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="transactions">üìù Transa√ß√µes</button>
            <button class="tab" data-tab="budget">üìä Or√ßamento</button>
            <button class="tab" data-tab="goals">üéØ Metas</button>
            <button class="tab" data-tab="accounts">üè¶ Contas</button>
            <button class="tab" data-tab="settings">‚öôÔ∏è Configura√ß√µes</button>
        </div>

        <div id="transactions-tab" class="tab-content active">
            <div class="controls">
                <h2>Adicionar Transa√ß√£o</h2>
                <form id="transactionForm">
                    <div class="form-group">
                        <div class="form-field">
                            <label for="desc">Descri√ß√£o</label>
                            <input type="text" id="desc" placeholder="Ex: Mercado, Gasolina..." required>
                        </div>
                        <div class="form-field">
                            <label for="amount">Valor (R$)</label>
                            <input type="number" id="amount" step="0.01" placeholder="0,00" required>
                        </div>
                        <div class="form-field">
                            <label for="date">Data</label>
                            <input type="date" id="date" required>
                        </div>
                        <div class="form-field">
                            <label for="type">Tipo</label>
                            <select id="type" required>
                                <option value="expense">üí∏ Despesa</option>
                                <option value="income">üí∞ Receita</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="form-field">
                            <label for="category">Categoria</label>
                            <select id="category" required></select>
                        </div>
                        <div class="form-field">
                            <label for="account">Conta</label>
                            <select id="account" required></select>
                        </div>
                    </div>
                    <div id="suggestionBox" class="suggestion-box">
                        <span class="suggestion-text">üí° Sugest√£o: <strong id="suggestedCategory"></strong></span>
                        <div class="suggestion-actions">
                            <button type="button" class="btn-success" id="acceptSuggestion">‚úì Aceitar</button>
                            <button type="button" class="btn-secondary" id="rejectSuggestion">‚úï Ignorar</button>
                        </div>
                    </div>
                    <div class="button-group" style="margin-top: var(--spacing-md);">
                        <button type="submit" class="btn-primary">‚ûï Adicionar</button>
                        <button type="button" class="btn-secondary" id="clearForm">üîÑ Limpar</button>
                    </div>
                </form>
            </div>

            <div class="controls">
                <h2>Hist√≥rico de Transa√ß√µes</h2>
                <div style="margin-bottom: var(--spacing-md); display: flex; gap: var(--spacing-md); flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: var(--spacing-xs);">
                        <label>M√™s:</label>
                        <select id="monthFilter"></select>
                    </div>
                    <div style="display: flex; align-items: center; gap: var(--spacing-xs);">
                        <label>Categoria:</label>
                        <select id="categoryFilter"><option value="">Todas</option></select>
                    </div>
                    <div style="display: flex; align-items: center; gap: var(--spacing-xs);">
                        <label>Conta:</label>
                        <select id="accountFilter"><option value="">Todas</option></select>
                    </div>
                </div>
                <div class="transactions">
                    <div class="transactions-header">
                        <div>Descri√ß√£o</div>
                        <div>Valor</div>
                        <div>Categoria</div>
                        <div>Data</div>
                        <div>Conta</div>
                        <div>A√ß√µes</div>
                    </div>
                    <div id="transactionsList"></div>
                </div>
            </div>
        </div>

        <div id="budget-tab" class="tab-content">
            <div class="controls">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                    <h2>Or√ßamento Mensal</h2>
                    <button class="btn-secondary" id="editBudgetBtn">‚úèÔ∏è Editar Or√ßamento</button>
                </div>
                <div id="budgetProgressContainer"></div>
            </div>
        </div>

        <div id="goals-tab" class="tab-content">
            <div class="controls">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                    <h2>Metas Financeiras</h2>
                    <button class="btn-primary" id="addGoalBtn">‚ûï Nova Meta</button>
                </div>
                <div id="goalsContainer"></div>
            </div>
        </div>

        <div id="accounts-tab" class="tab-content">
            <div class="controls">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                    <h2>Contas e Cart√µes</h2>
                    <button class="btn-primary" id="addAccountBtn">‚ûï Nova Conta</button>
                </div>
                <div id="accountsContainer"></div>
            </div>
        </div>

        <div id="settings-tab" class="tab-content">
            <div class="controls">
                <h2>Configura√ß√µes e Backup</h2>

                <div style="margin: var(--spacing-xl) 0;">
                    <h3 style="margin-bottom: var(--spacing-md);">üìÇ Backup e Sincroniza√ß√£o</h3>
                    <div class="button-group">
                        <button class="btn-primary" id="exportBtn">üíæ Exportar Dados</button>
                        <button class="btn-secondary" id="importBtn">üì§ Importar Dados</button>
                        <input type="file" id="importFile" accept=".json" style="display: none;">
                    </div>
                </div>

                <div style="margin: var(--spacing-xl) 0;">
                    <h3 style="margin-bottom: var(--spacing-md); color: var(--color-danger);">‚ö†Ô∏è Zona de Perigo</h3>
                    <p style="color: var(--color-text-muted); margin-bottom: var(--spacing-md); font-size: 0.9rem;">
                        Opera√ß√µes irrevers√≠veis. Use com cuidado!
                    </p>
                    <button class="btn-danger" id="clearAllBtn">üóëÔ∏è Limpar Todos os Dados</button>
                </div>
            </div>
        </div>
    </div>

    <div id="budgetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Configurar Or√ßamento Mensal</h2>
                <button class="modal-close" onclick="document.getElementById('budgetModal').classList.remove('show')">√ó</button>
            </div>
            <form id="budgetForm">
                <div id="budgetCategoriesForm"></div>
                <div class="button-group" style="margin-top: var(--spacing-lg);">
                    <button type="submit" class="btn-primary">üíæ Salvar</button>
                    <button type="button" class="btn-secondary" onclick="document.getElementById('budgetModal').classList.remove('show')">‚úï Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="goalModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Meta Financeira</h2>
                <button class="modal-close" onclick="document.getElementById('goalModal').classList.remove('show')">√ó</button>
            </div>
            <form id="goalForm">
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="goalName">Nome da Meta</label>
                    <input type="text" id="goalName" placeholder="Ex: Viagem, Emerg√™ncia..." required>
                </div>
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="goalTarget">Valor Alvo (R$)</label>
                    <input type="number" id="goalTarget" step="0.01" placeholder="0,00" required>
                </div>
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="goalCurrent">Valor Atual (R$)</label>
                    <input type="number" id="goalCurrent" step="0.01" placeholder="0,00" value="0">
                </div>
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="goalDeadline">Prazo</label>
                    <input type="date" id="goalDeadline" required>
                </div>
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="goalAccount">Conta Vinculada</label>
                    <select id="goalAccount" required></select>
                </div>
                <div class="button-group" style="margin-top: var(--spacing-lg);">
                    <button type="submit" class="btn-primary">üíæ Salvar</button>
                    <button type="button" class="btn-secondary" onclick="document.getElementById('goalModal').classList.remove('show')">‚úï Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="accountModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Conta/Cart√£o</h2>
                <button class="modal-close" onclick="document.getElementById('accountModal').classList.remove('show')">√ó</button>
            </div>
            <form id="accountForm">
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="accountName">Nome da Conta</label>
                    <input type="text" id="accountName" placeholder="Ex: Conta Corrente..." required>
                </div>
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="accountType">Tipo</label>
                    <select id="accountType" required>
                        <option value="checking">Conta Corrente</option>
                        <option value="savings">Poupan√ßa</option>
                        <option value="credit">Cart√£o de Cr√©dito</option>
                        <option value="investment">Investimento</option>
                    </select>
                </div>
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="accountPurpose">Finalidade</label>
                    <select id="accountPurpose" required>
                        <option value="general">Geral</option>
                        <option value="bills">Contas Fixas</option>
                        <option value="daily">Gastos Di√°rios</option>
                        <option value="emergency">Reserva Emerg√™ncia</option>
                        <option value="goal">Meta Espec√≠fica</option>
                    </select>
                </div>
                <div class="form-field" style="margin-bottom: var(--spacing-md);">
                    <label for="accountBalance">Saldo Inicial (R$)</label>
                    <input type="number" id="accountBalance" step="0.01" placeholder="0,00" value="0">
                </div>
                <div class="button-group" style="margin-top: var(--spacing-lg);">
                    <button type="submit" class="btn-primary">üíæ Salvar</button>
                    <button type="button" class="btn-secondary" onclick="document.getElementById('accountModal').classList.remove('show')">‚úï Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script>
'use strict';

const APP_CONFIG = {
    version: '2.2.0',
    googleClientId: '576473287840-cb63ib6vjfamk3le7detfeqpk4v9obh1.apps.googleusercontent.com',
    googleApiKey: 'AIzaSyA4lbvkd1_57ifjhpbt0vzT9IRNNZMl8rU',
    driveFileName: 'finance-control-pro-data.json'
};

let appData = {
    version: APP_CONFIG.version,
    family: {name: 'Minha Fam√≠lia', members: []},
    accounts: [{id: 'acc_1', name: 'Conta Principal', type: 'checking', purpose: 'general', balance: 0}],
    categories: [
        {name: 'Moradia', type: 'need', icon: 'üè†'},
        {name: 'Alimenta√ß√£o', type: 'need', icon: 'üçΩÔ∏è'},
        {name: 'Transporte', type: 'need', icon: 'üöó'},
        {name: 'Sa√∫de', type: 'need', icon: 'üè•'},
        {name: 'Educa√ß√£o', type: 'need', icon: 'üìö'},
        {name: 'Lazer', type: 'want', icon: 'üéâ'},
        {name: 'Restaurante', type: 'want', icon: 'üçï'},
        {name: 'Assinaturas', type: 'want', icon: 'üì∫'},
        {name: 'Vestu√°rio', type: 'want', icon: 'üëï'},
        {name: 'Poupan√ßa', type: 'saving', icon: 'üí∞'},
        {name: 'Investimento', type: 'saving', icon: 'üìà'},
        {name: 'Outros', type: 'other', icon: 'üì¶'}
    ],
    budget: {},
    transactions: [],
    goals: [],
    categorizationLearning: {}
};

const categorizationRules = {
    'Moradia': ['aluguel', 'condom√≠nio', 'iptu', '√°gua', 'luz', 'energia', 'g√°s', 'internet', 'telefone', 'tinta', 'parede', 'reforma'],
    'Alimenta√ß√£o': ['mercado', 'supermercado', 'padaria', 'a√ßougue', 'feira'],
    'Transporte': ['gasolina', 'combust√≠vel', 'uber', '99', 't√°xi', '√¥nibus'],
    'Sa√∫de': ['farm√°cia', 'm√©dico', 'dentista', 'hospital', 'rem√©dio'],
    'Educa√ß√£o': ['escola', 'faculdade', 'curso', 'livro'],
    'Lazer': ['cinema', 'teatro', 'show', 'viagem'],
    'Restaurante': ['restaurante', 'delivery', 'ifood']
};

let googleAccessToken = null;
let driveFileId = null;

function init() {
    loadData();
    setupUI();
    setupEvents();
    renderAll();
    initGoogle();
}

function loadData() {
    const saved = localStorage.getItem('financeData');
    if (saved) {
        try {
            appData = JSON.parse(saved);
        } catch (e) {
            console.error('Erro ao carregar dados:', e);
        }
    }
}

function saveData() {
    localStorage.setItem('financeData', JSON.stringify(appData));
}

function setupUI() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('date').value = today;

    populateCategories();
    populateAccounts();
    populateMonths();
}

function populateCategories() {
    const select = document.getElementById('category');
    const filter = document.getElementById('categoryFilter');

    select.innerHTML = '';

    appData.categories.forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat.name;
        opt.textContent = cat.icon + ' ' + cat.name;
        select.appendChild(opt);

        if (filter) {
            const opt2 = opt.cloneNode(true);
            filter.appendChild(opt2);
        }
    });
}

function populateAccounts() {
    ['account', 'accountFilter', 'goalAccount'].forEach(id => {
        const select = document.getElementById(id);
        if (!select) return;

        const isFilter = id === 'accountFilter';
        select.innerHTML = isFilter ? '<option value="">Todas</option>' : '';

        appData.accounts.forEach(acc => {
            const opt = document.createElement('option');
            opt.value = acc.id;
            opt.textContent = acc.name;
            select.appendChild(opt);
        });
    });
}

function populateMonths() {
    const select = document.getElementById('monthFilter');
    const months = new Set();
    const now = new Date();

    months.add(now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0'));

    appData.transactions.forEach(t => {
        const d = new Date(t.date);
        months.add(d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0'));
    });

    const sorted = Array.from(months).sort().reverse();
    select.innerHTML = '';

    sorted.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m;
        const parts = m.split('-');
        const date = new Date(parts[0], parseInt(parts[1]) - 1);
        opt.textContent = date.toLocaleDateString('pt-BR', {month: 'long', year: 'numeric'});
        opt.textContent = opt.textContent.charAt(0).toUpperCase() + opt.textContent.slice(1);
        select.appendChild(opt);
    });
}

function setupEvents() {
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            tab.classList.add('active');
            document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
        });
    });

    document.getElementById('transactionForm').addEventListener('submit', addTransaction);
    document.getElementById('clearForm').addEventListener('click', clearForm);

    document.getElementById('desc').addEventListener('input', e => {
        const suggestion = suggestCategory(e.target.value);
        const box = document.getElementById('suggestionBox');
        if (suggestion && suggestion.confidence >= 0.8) {
            document.getElementById('suggestedCategory').textContent = suggestion.category;
            box.classList.add('show');
        } else {
            box.classList.remove('show');
        }
    });

    document.getElementById('acceptSuggestion').addEventListener('click', () => {
        document.getElementById('category').value = document.getElementById('suggestedCategory').textContent;
        document.getElementById('suggestionBox').classList.remove('show');
    });

    document.getElementById('rejectSuggestion').addEventListener('click', () => {
        document.getElementById('suggestionBox').classList.remove('show');
    });

    ['monthFilter', 'categoryFilter', 'accountFilter'].forEach(id => {
        document.getElementById(id).addEventListener('change', renderTransactions);
    });

    document.getElementById('editBudgetBtn').addEventListener('click', openBudgetModal);
    document.getElementById('budgetForm').addEventListener('submit', saveBudget);

    document.getElementById('addGoalBtn').addEventListener('click', openGoalModal);
    document.getElementById('goalForm').addEventListener('submit', saveGoal);

    document.getElementById('addAccountBtn').addEventListener('click', openAccountModal);
    document.getElementById('accountForm').addEventListener('submit', saveAccount);

    document.getElementById('exportBtn').addEventListener('click', exportData);
    document.getElementById('importBtn').addEventListener('click', () => document.getElementById('importFile').click());
    document.getElementById('importFile').addEventListener('change', importData);
    document.getElementById('clearAllBtn').addEventListener('click', clearAll);

    document.getElementById('googleSignInBtn').addEventListener('click', googleSignIn);
    document.getElementById('googleSignOutBtn').addEventListener('click', googleSignOut);
    document.getElementById('syncBtn').addEventListener('click', syncDrive);
}

function suggestCategory(desc) {
    const lower = desc.toLowerCase();

    if (appData.categorizationLearning[lower]) {
        return {category: appData.categorizationLearning[lower], confidence: 1.0};
    }

    for (const cat in categorizationRules) {
        const keywords = categorizationRules[cat];
        for (const kw of keywords) {
            if (lower.includes(kw)) {
                return {category: cat, confidence: 0.8};
            }
        }
    }

    return null;
}

function addTransaction(e) {
    e.preventDefault();

    const trans = {
        id: 'txn_' + Date.now(),
        description: document.getElementById('desc').value,
        amount: parseFloat(document.getElementById('amount').value) * (document.getElementById('type').value === 'expense' ? -1 : 1),
        date: document.getElementById('date').value,
        category: document.getElementById('category').value,
        account_id: document.getElementById('account').value,
        type: document.getElementById('type').value,
        timestamp: new Date().toISOString()
    };

    appData.transactions.push(trans);

    appData.categorizationLearning[trans.description.toLowerCase()] = trans.category;

    saveData();
    clearForm();
    renderAll();
    showAlert('success', 'Transa√ß√£o adicionada!');
}

function clearForm() {
    document.getElementById('transactionForm').reset();
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('date').value = today;
    document.getElementById('suggestionBox').classList.remove('show');
}

function deleteTransaction(id) {
    if (!confirm('Excluir transa√ß√£o?')) return;
    appData.transactions = appData.transactions.filter(t => t.id !== id);
    saveData();
    renderAll();
    showAlert('success', 'Transa√ß√£o exclu√≠da!');
}

function renderAll() {
    renderDashboard();
    renderTransactions();
    renderBudget();
    renderGoals();
    renderAccounts();
    populateMonths();
}

function renderDashboard() {
    const month = document.getElementById('monthFilter').value || getCurrentMonth();
    const trans = appData.transactions.filter(t => t.date.startsWith(month));

    const income = trans.filter(t => t.type === 'income').reduce((s, t) => s + Math.abs(t.amount), 0);
    const expense = trans.filter(t => t.type === 'expense').reduce((s, t) => s + Math.abs(t.amount), 0);
    const balance = income - expense;

    document.getElementById('totalIncome').textContent = formatMoney(income);
    document.getElementById('totalExpense').textContent = formatMoney(expense);
    document.getElementById('balance').textContent = formatMoney(balance);

    const savingsRate = income > 0 ? (balance / income * 100) : 0;
    document.getElementById('savingsRate').textContent = savingsRate.toFixed(1) + '%';

    const emergAcc = appData.accounts.find(a => a.purpose === 'emergency');
    const emergBalance = emergAcc ? emergAcc.balance : 0;
    const runway = expense > 0 ? (emergBalance / expense) : 0;
    document.getElementById('runway').textContent = runway.toFixed(1);

    checkAlerts();
}

function renderTransactions() {
    const container = document.getElementById('transactionsList');
    const month = document.getElementById('monthFilter').value;
    const cat = document.getElementById('categoryFilter').value;
    const acc = document.getElementById('accountFilter').value;

    let filtered = appData.transactions;

    if (month) filtered = filtered.filter(t => t.date.startsWith(month));
    if (cat) filtered = filtered.filter(t => t.category === cat);
    if (acc) filtered = filtered.filter(t => t.account_id === acc);

    filtered.sort((a, b) => new Date(b.date) - new Date(a.date));

    if (filtered.length === 0) {
        container.innerHTML = '<div class="no-data">Nenhuma transa√ß√£o encontrada</div>';
        return;
    }

    container.innerHTML = filtered.map(t => {
        const account = appData.accounts.find(a => a.id === t.account_id);
        const category = appData.categories.find(c => c.name === t.category);

        return '<div class="transaction-item">' +
            '<div class="transaction-desc"><strong>' + t.description + '</strong><small>' + (category ? category.icon : '') + ' ' + t.category + '</small></div>' +
            '<div class="transaction-amount ' + t.type + '">' + formatMoney(Math.abs(t.amount)) + '</div>' +
            '<div>' + t.category + '</div>' +
            '<div>' + formatDate(t.date) + '</div>' +
            '<div class="transaction-account">' + (account ? account.name : '') + '</div>' +
            '<div><button class="btn-danger" onclick="deleteTransaction('' + t.id + '')">üóëÔ∏è</button></div>' +
            '</div>';
    }).join('');
}

function openBudgetModal() {
    const form = document.getElementById('budgetCategoriesForm');
    const month = getCurrentMonth();
    const budget = appData.budget[month] || {};

    form.innerHTML = appData.categories.filter(c => c.type !== 'other').map(cat => {
        const val = budget[cat.name] || 0;
        return '<div class="form-field" style="margin-bottom: var(--spacing-md);"><label>' + cat.icon + ' ' + cat.name + '</label>' +
            '<input type="number" step="0.01" name="budget_' + cat.name + '" value="' + val + '" placeholder="0,00"></div>';
    }).join('');

    document.getElementById('budgetModal').classList.add('show');
}

function saveBudget(e) {
    e.preventDefault();
    const form = new FormData(e.target);
    const month = getCurrentMonth();

    appData.budget[month] = {};

    for (const pair of form.entries()) {
        if (pair[0].startsWith('budget_')) {
            const cat = pair[0].replace('budget_', '');
            appData.budget[month][cat] = parseFloat(pair[1]) || 0;
        }
    }

    saveData();
    renderBudget();
    document.getElementById('budgetModal').classList.remove('show');
    showAlert('success', 'Or√ßamento salvo!');
}

function renderBudget() {
    const container = document.getElementById('budgetProgressContainer');
    const month = getCurrentMonth();
    const budget = appData.budget[month] || {};
    const trans = appData.transactions.filter(t => t.date.startsWith(month) && t.type === 'expense');

    if (Object.keys(budget).length === 0) {
        container.innerHTML = '<div class="no-data">Configure um or√ßamento clicando em Editar Or√ßamento</div>';
        return;
    }

    const items = Object.keys(budget).map(cat => {
        const planned = budget[cat];
        const spent = trans.filter(t => t.category === cat).reduce((s, t) => s + Math.abs(t.amount), 0);
        const pct = planned > 0 ? (spent / planned * 100) : 0;
        const status = pct >= 100 ? 'danger' : pct >= 80 ? 'warning' : 'safe';

        return {cat, planned, spent, pct, status};
    });

    container.innerHTML = items.map(i => 
        '<div class="budget-progress"><div class="budget-category">' +
        '<div class="budget-header"><span class="budget-name">' + i.cat + '</span>' +
        '<span class="budget-amounts">' + formatMoney(i.spent) + ' / ' + formatMoney(i.planned) + '</span></div>' +
        '<div class="budget-bar"><div class="budget-fill ' + i.status + '" style="width: ' + Math.min(i.pct, 100) + '%"></div></div>' +
        '</div></div>'
    ).join('');
}

function checkAlerts() {
    const container = document.getElementById('alertsContainer');
    const month = getCurrentMonth();
    const budget = appData.budget[month] || {};
    const trans = appData.transactions.filter(t => t.date.startsWith(month) && t.type === 'expense');

    const alerts = [];

    Object.keys(budget).forEach(cat => {
        const planned = budget[cat];
        const spent = trans.filter(t => t.category === cat).reduce((s, t) => s + Math.abs(t.amount), 0);
        const pct = planned > 0 ? (spent / planned * 100) : 0;

        if (pct >= 80 && pct < 100) {
            alerts.push('<div class="alert warning"><span class="alert-icon">‚ö†Ô∏è</span><span>Categoria <strong>' + cat + '</strong> em ' + pct.toFixed(0) + '%</span></div>');
        } else if (pct >= 100) {
            alerts.push('<div class="alert warning"><span class="alert-icon">üö®</span><span>Categoria <strong>' + cat + '</strong> estourou! ' + pct.toFixed(0) + '%</span></div>');
        }
    });

    container.innerHTML = alerts.join('');
}

function openGoalModal() {
    populateAccounts();
    document.getElementById('goalForm').reset();
    document.getElementById('goalCurrent').value = '0';
    document.getElementById('goalModal').classList.add('show');
}

function saveGoal(e) {
    e.preventDefault();

    const goal = {
        id: 'goal_' + Date.now(),
        name: document.getElementById('goalName').value,
        target: parseFloat(document.getElementById('goalTarget').value),
        current: parseFloat(document.getElementById('goalCurrent').value) || 0,
        deadline: document.getElementById('goalDeadline').value,
        account_id: document.getElementById('goalAccount').value
    };

    appData.goals.push(goal);
    saveData();
    renderGoals();
    document.getElementById('goalModal').classList.remove('show');
    showAlert('success', 'Meta criada!');
}

function deleteGoal(id) {
    if (!confirm('Excluir meta?')) return;
    appData.goals = appData.goals.filter(g => g.id !== id);
    saveData();
    renderGoals();
    showAlert('success', 'Meta exclu√≠da!');
}

function renderGoals() {
    const container = document.getElementById('goalsContainer');

    if (appData.goals.length === 0) {
        container.innerHTML = '<div class="no-data">Nenhuma meta. Clique em Nova Meta</div>';
        return;
    }

    container.innerHTML = appData.goals.map(g => {
        const pct = (g.current / g.target * 100).toFixed(1);
        const acc = appData.accounts.find(a => a.id === g.account_id);
        const days = Math.ceil((new Date(g.deadline) - new Date()) / 86400000);

        return '<div class="goal-card">' +
            '<div class="goal-header"><span class="goal-name">' + g.name + '</span><span class="goal-progress-text">' + pct + '%</span></div>' +
            '<div style="margin-bottom: var(--spacing-sm);"><div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: var(--color-text-muted); margin-bottom: var(--spacing-xs);">' +
            '<span>' + formatMoney(g.current) + '</span><span>' + formatMoney(g.target) + '</span></div>' +
            '<div class="budget-bar"><div class="budget-fill safe" style="width: ' + Math.min(pct, 100) + '%"></div></div></div>' +
            '<div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--color-text-muted);"><span>üìÖ ' + days + ' dias</span>' +
            '<span>üè¶ ' + (acc ? acc.name : '') + '</span></div>' +
            '<div style="margin-top: var(--spacing-sm);"><button class="btn-danger" onclick="deleteGoal('' + g.id + '')">üóëÔ∏è Excluir</button></div></div>';
    }).join('');
}

function openAccountModal() {
    document.getElementById('accountForm').reset();
    document.getElementById('accountBalance').value = '0';
    document.getElementById('accountModal').classList.add('show');
}

function saveAccount(e) {
    e.preventDefault();

    const acc = {
        id: 'acc_' + Date.now(),
        name: document.getElementById('accountName').value,
        type: document.getElementById('accountType').value,
        purpose: document.getElementById('accountPurpose').value,
        balance: parseFloat(document.getElementById('accountBalance').value) || 0
    };

    appData.accounts.push(acc);
    saveData();
    populateAccounts();
    renderAccounts();
    document.getElementById('accountModal').classList.remove('show');
    showAlert('success', 'Conta criada!');
}

function deleteAccount(id) {
    if (appData.accounts.length === 1) {
        alert('Precisa ter pelo menos uma conta');
        return;
    }
    if (!confirm('Excluir conta?')) return;
    appData.accounts = appData.accounts.filter(a => a.id !== id);
    saveData();
    populateAccounts();
    renderAccounts();
    showAlert('success', 'Conta exclu√≠da!');
}

function renderAccounts() {
    const container = document.getElementById('accountsContainer');

    const types = {checking: 'Conta Corrente', savings: 'Poupan√ßa', credit: 'Cart√£o', investment: 'Investimento'};
    const purposes = {general: 'Geral', bills: 'Contas Fixas', daily: 'Di√°rio', emergency: 'Emerg√™ncia', goal: 'Meta'};

    container.innerHTML = appData.accounts.map(a =>
        '<div class="goal-card"><div class="goal-header"><span class="goal-name">' + a.name + '</span>' +
        '<span class="goal-progress-text">' + formatMoney(a.balance) + '</span></div>' +
        '<div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--color-text-muted); margin-top: var(--spacing-sm);">' +
        '<span>üìã ' + types[a.type] + '</span><span>üéØ ' + purposes[a.purpose] + '</span></div>' +
        '<div style="margin-top: var(--spacing-sm);"><button class="btn-danger" onclick="deleteAccount('' + a.id + '')">üóëÔ∏è Excluir</button></div></div>'
    ).join('');
}

function exportData() {
    const str = JSON.stringify(appData, null, 2);
    const blob = new Blob([str], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'finance-backup-' + new Date().toISOString().split('T')[0] + '.json';
    a.click();
    URL.revokeObjectURL(url);
    showAlert('success', 'Dados exportados!');
}

function importData(e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(ev) {
        try {
            const imported = JSON.parse(ev.target.result);
            if (!confirm('Importar substituir√° todos os dados. Continuar?')) return;
            appData = imported;
            saveData();
            location.reload();
        } catch (err) {
            alert('Erro ao importar arquivo');
        }
    };
    reader.readAsText(file);
}

function clearAll() {
    if (!confirm('ATEN√á√ÉO: Apagar√° TODOS os dados! Continuar?')) return;
    if (!confirm('√öltima confirma√ß√£o: dados ser√£o perdidos permanentemente!')) return;
    localStorage.clear();
    location.reload();
}

function initGoogle() {
    if (typeof gapi === 'undefined') return;

    gapi.load('client', async () => {
        try {
            await gapi.client.init({
                apiKey: APP_CONFIG.googleApiKey,
                discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest']
            });
        } catch (e) {
            console.error('Google API erro:', e);
        }
    });

    if (typeof google !== 'undefined') {
        google.accounts.id.initialize({
            client_id: APP_CONFIG.googleClientId,
            callback: () => {}
        });
    }
}

function googleSignIn() {
    if (typeof google === 'undefined') {
        alert('Google API n√£o carregada. Publique no GitHub Pages para funcionar.');
        return;
    }

    const tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: APP_CONFIG.googleClientId,
        scope: 'https://www.googleapis.com/auth/drive.file',
        callback: (resp) => {
            googleAccessToken = resp.access_token;
            gapi.client.setToken({access_token: googleAccessToken});
            document.getElementById('googleSignInBtn').style.display = 'none';
            document.getElementById('googleSignOutBtn').style.display = 'block';
            document.getElementById('syncBtn').disabled = false;
            showAlert('success', 'Login realizado!');
            loadFromDrive();
        }
    });

    tokenClient.requestAccessToken();
}

function googleSignOut() {
    googleAccessToken = null;
    driveFileId = null;
    if (typeof gapi !== 'undefined') gapi.client.setToken(null);
    document.getElementById('googleSignInBtn').style.display = 'block';
    document.getElementById('googleSignOutBtn').style.display = 'none';
    document.getElementById('syncBtn').disabled = true;
    showAlert('success', 'Logout realizado!');
}

async function syncDrive() {
    if (!googleAccessToken) {
        alert('Fa√ßa login primeiro');
        return;
    }

    try {
        showAlert('success', 'Sincronizando...');

        await findOrCreateFile();

        const content = JSON.stringify(appData, null, 2);
        const blob = new Blob([content], {type: 'application/json'});

        const meta = {name: APP_CONFIG.driveFileName, mimeType: 'application/json'};
        const form = new FormData();
        form.append('metadata', new Blob([JSON.stringify(meta)], {type: 'application/json'}));
        form.append('file', blob);

        const resp = await fetch('https://www.googleapis.com/upload/drive/v3/files/' + driveFileId + '?uploadType=multipart', {
            method: 'PATCH',
            headers: {Authorization: 'Bearer ' + googleAccessToken},
            body: form
        });

        if (resp.ok) {
            showAlert('success', 'Sincronizado com Drive!');
        } else {
            throw new Error('Erro');
        }
    } catch (e) {
        console.error(e);
        showAlert('warning', 'Erro ao sincronizar');
    }
}

async function findOrCreateFile() {
    try {
        const resp = await gapi.client.drive.files.list({
            q: "name='" + APP_CONFIG.driveFileName + "' and trashed=false",
            fields: 'files(id, name)',
            spaces: 'drive'
        });

        if (resp.result.files && resp.result.files.length > 0) {
            driveFileId = resp.result.files[0].id;
        } else {
            const createResp = await gapi.client.drive.files.create({
                resource: {name: APP_CONFIG.driveFileName, mimeType: 'application/json'},
                fields: 'id'
            });
            driveFileId = createResp.result.id;
        }
    } catch (e) {
        throw e;
    }
}

async function loadFromDrive() {
    if (!googleAccessToken) return;

    try {
        await findOrCreateFile();

        const resp = await fetch('https://www.googleapis.com/drive/v3/files/' + driveFileId + '?alt=media', {
            headers: {Authorization: 'Bearer ' + googleAccessToken}
        });

        if (resp.ok) {
            const data = await resp.json();
            if (confirm('Dados encontrados no Drive. Carregar?')) {
                appData = data;
                saveData();
                location.reload();
            }
        }
    } catch (e) {
        console.log('Sem dados no Drive:', e);
    }
}

function formatMoney(val) {
    return new Intl.NumberFormat('pt-BR', {style: 'currency', currency: 'BRL'}).format(val);
}

function formatDate(str) {
    return new Date(str + 'T00:00:00').toLocaleDateString('pt-BR');
}

function getCurrentMonth() {
    const now = new Date();
    return now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0');
}

function showAlert(type, msg) {
    const container = document.getElementById('alertsContainer');
    const div = document.createElement('div');
    div.className = 'alert ' + type;
    div.innerHTML = '<span class="alert-icon">' + (type === 'success' ? '‚úì' : '‚ö†Ô∏è') + '</span><span>' + msg + '</span>';
    container.insertBefore(div, container.firstChild);
    setTimeout(() => div.remove(), 5000);
}

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    init();
}
    </script>
</body>
</html>
